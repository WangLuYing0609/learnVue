{"version":3,"file":"vue.js","sources":["../../src/utils/index.js","../../src/observer/array.js","../../src/observer/index.js","../../src/state.js","../../src/init.js","../../src/index.js"],"sourcesContent":["export function isObject(data) {\n    return typeof data === 'object' && data !== null\n}\nexport function def(data, key, val) {\n    Object.defineProperty(data, key, {\n        enumerable: false,\n        configurable: false,\n        value: val\n    })\n}","//  重写数组的方法   push shift unshift pop reverse sort splice   会导致数组本身发生变化\nlet oldArryMethods = Array.prototype;\nexport const arryMethods = Object.create(oldArryMethods)\n\nconst methods = [\n    'push', 'shift', 'unshift', 'shift', 'pop', 'reverse', 'sort', 'splice'\n]\n\nmethods.forEach((item) => {\n    arryMethods[item] = function (...args) {\n        console.log('调用push');\n        // 切片编程\n        const result = oldArryMethods[item].apply(this, args) //调用原生方法\n        // push unshift 添加的元素可能还是一个对象\n        let inserted;//用户插入的数据\n        let ob = this.__ob__;\n        switch (item) {\n            case 'push':\n            case 'unshift':\n                inserted = args;\n                break;\n            case 'splice':\n                inserted = args.slice(2)\n                break;\n            default:\n                break;\n        }\n        if (inserted) ob.observerArry(inserted) // 将新增属性继续监听\n\n        return result\n    }\n})","// 把data中的数据 使用Object.defineProperty重新定义\n// Object.defineProperty不能兼容ie8及以下   vue2无法兼容ie8\n// vue3使用proxy\nimport { isObject, def } from '../utils/index'\nimport { arryMethods } from './array'\nclass Observer {\n    constructor(val) {\n        // 给每一个监控过的对象增加__ob__属性\n        def(val, '__ob__', this)\n        // val如果数据的层次多，就需要递归\n        if (Array.isArray(val)) {\n            // 数据劫持  数组每一项劫持  重写数组的方法\n            val.__proto__ = arryMethods\n            this.observerArry(val)\n        } else {\n            this.walk(val)\n        }\n\n    }\n    observerArry(data) {\n        for (let i = 0; i < data.length; i++) {\n            observer(data[i])\n        }\n    }\n    walk(data) {\n        let keys = Object.keys(data)\n        keys.forEach(key => {\n            defineReactive(data, key, data[key])\n        })\n    }\n}\nfunction defineReactive(data, key, value) {\n    observer(value)\n    Object.defineProperty(data, key, {\n        get() {\n            return value\n        },\n        set(newVal) {\n\n            if (newVal !== value) {\n                value = newVal\n                observer(value)\n            }\n        }\n    })\n}\nexport function observer(data) {\n    if (!isObject(data)) {\n        return\n    }\n    return new Observer(data)\n}","import { observer } from './observer/index'\n\n\nexport function initState(vm) {\n    const opts = vm.$options\n    if (opts.props) {\n        initProps(vm)\n    }\n    if (opts.methods) {\n        initMethods(vm)\n    }\n    if (opts.data) {\n        initData(vm)\n    }\n    if (opts.computed) {\n        intiComuted(vm)\n    }\n    if (opts.watch) {\n        initWach(vm)\n    }\n}\nfunction initProps(vm) { }\nfunction initMethods(vm) { }\nfunction initData(vm) {\n    // 数据初始化\n    let data = vm.$options.data()//用户传递的\n    data = vm._data = typeof data === 'function' ? data.call(vm) : data\n    //对象劫持\n    observer(data)\n}\nfunction intiComuted(vm) { }\nfunction initWach(vm) { }\n","import { initState } from './state'\n// 原型上添加init方法\nexport function initMixin(Vue) {\n    // 初始化流程\n    Vue.prototype._init = function (options) {\n        // 数据劫持\n        const vm = this //vue中使用this.$options 指代用户的传递属性\n        vm.$options = options\n        // 初始化状态\n        initState(vm)\n    }\n}","import { initMixin } from './init'\n\n\n\nfunction Vue(opation) {\n    // 进行Vue的初始化操作\n    this._init(opation)\n}\n// 通过引入文件的方法给原型上添加一个_init方法\ninitMixin(Vue)   //给Vue上添加一个_init方法\nexport default Vue"],"names":["isObject","data","def","key","val","Object","defineProperty","enumerable","configurable","value","oldArryMethods","Array","prototype","arryMethods","create","methods","forEach","item","console","log","args","result","apply","inserted","ob","__ob__","slice","observerArry","Observer","isArray","__proto__","walk","i","length","observer","keys","defineReactive","get","set","newVal","initState","vm","opts","$options","props","initData","computed","watch","_data","call","initMixin","Vue","_init","options","opation"],"mappings":"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"}