{"version":3,"file":"vue.js","sources":["../../src/utils/index.js","../../src/observer/array.js","../../src/observer/index.js","../../src/state.js","../../src/compiler/index.js","../../src/init.js","../../src/index.js"],"sourcesContent":["export function isFunction(data) {\n    return typeof data === 'function'\n}\n\nexport function isObject(data) {\n    return typeof data === 'object' && data !== null\n}\nexport function def(data, key, val) {\n    Object.defineProperty(data, key, {\n        enumerable: false,\n        configurable: false,\n        value: val\n    })\n}","//  重写数组的方法   push shift unshift pop reverse sort splice   会导致数组本身发生变化\nlet oldArryMethods = Array.prototype;\nexport let arryMethods = Object.create(oldArryMethods)\n// arryMethods.__proto__ = Arry.prototype  继承\n\nconst methods = [\n    'push', 'shift', 'unshift', 'shift', 'pop', 'reverse', 'sort', 'splice'\n]\n\nmethods.forEach((item) => {\n    arryMethods[item] = function (...args) {\n        console.log('调用push');\n        // 切片编程\n        const result = oldArryMethods[item].apply(this, args) //调用原生方法\n        // push unshift splice添加的元素可能还是一个对象\n        let inserted;//用户插入的数据\n        let ob = this.__ob__;//根据当前实例获取observer方法\n        switch (item) {\n            case 'push':\n            case 'unshift':\n                inserted = args;\n                break;\n            case 'splice':\n                inserted = args.slice(2)\n                break;\n            default:\n                break;\n        }\n        if (inserted) ob.observerArry(inserted) // 将新增属性继续监听\n\n        return result\n    }\n})","// 把data中的数据 使用Object.defineProperty重新定义\n// Object.defineProperty不能兼容ie8及以下   vue2无法兼容ie8\n// vue3使用proxy\nimport { isObject, def } from '../utils/index'\nimport { arryMethods } from './array'\nclass Observer {\n    constructor(val) {\n        // 给每一个监控过的对象增加__ob__属性\n        def(val, '__ob__', this)\n        // val如果数据的层次多，就需要递归\n        if (Array.isArray(val)) {\n            // 数据劫持  数组每一项劫持  重写数组的方法\n            val.__proto__ = arryMethods\n            this.observerArry(val)\n        } else {\n            this.walk(val)\n        }\n\n    }\n    observerArry(data) {\n        for (let i = 0; i < data.length; i++) {\n            observer(data[i])\n        }\n    }\n    walk(data) {\n        let keys = Object.keys(data)\n        keys.forEach(key => {\n            defineReactive(data, key, data[key])\n        })\n    }\n}\nfunction defineReactive(data, key, value) {\n    observer(value)\n    Object.defineProperty(data, key, {\n        get() {\n            return value\n        },\n        set(newVal) {\n\n            if (newVal !== value) {\n                value = newVal\n                observer(value)\n            }\n        }\n    })\n}\nexport function observer(data) {\n    if (!isObject(data)) {\n        return\n    }\n    if (data.__ob__) {\n        return\n    }\n    return new Observer(data)\n}","import { observer } from './observer/index'\nimport { isFunction } from './utils/index'\n\n\nexport function initState(vm) {\n    const opts = vm.$options\n    if (opts.props) {\n        initProps(vm)\n    }\n    if (opts.methods) {\n        initMethods(vm)\n    }\n    if (opts.data) {\n        initData(vm)\n    }\n    if (opts.computed) {\n        intiComuted(vm)\n    }\n    if (opts.watch) {\n        initWach(vm)\n    }\n}\nfunction initProps(vm) { }\nfunction initMethods(vm) { }\nfunction proxy(vm, source, key) {\n    Object.defineProperty(vm, key, {\n        get() {\n            return vm[source][key]\n        },\n        set(newVal) {\n            vm[source][key] = newVal\n        }\n    })\n}\nfunction initData(vm) {\n    // 数据初始化\n    let data = vm.$options.data()//用户传递的   vue内部会对属性检测，如果是以$开头 不会进行\n    data = vm._data = isFunction(data) ? data.call(vm) : data\n\n    for (let key in data) {\n        proxy(vm, '_data', key)\n    }\n\n\n    //对象劫持\n    observer(data)\n}\nfunction intiComuted(vm) { }\nfunction initWach(vm) { }\n","const cname = '[a-zA-Z_][\\\\w\\\\-\\\\.]*'; //标签名   \nconst qnameCapture = `((?:${cname}\\\\:)?${cname})`;  //获取标签名\nconst startTagOpen = new RegExp(`^<${qnameCapture}`);  //匹配开始标签\nconst endTag = new RegExp('^<\\\\/' + qnameCapture + '[^>]*>');  //匹配闭合标签\n// aa = \"xxxx\" | 'xxxx' | xxxx\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/;\nconst startTagClose = /^\\s*(\\/?)>/;   //标签关闭 > />\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g; //{{}}\n\n//  Html字符串解析成对应的脚本 \n\nfunction parserHTML(html) {\n    function advance(len) {\n        html = html.substring(len)\n    }\n    function start(tagName,attr) {\n\n    }\n    function parseStartTag() {\n        const start = html.match(startTagOpen)\n        if (start) {\n            const match = {\n                tagName: start[1],\n                attrs: []\n            }\n            advance(start[0].length)\n            let end, attr\n            while (!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {\n                match.attrs.push([{ name: attr[1], value: attr[3] || attr[4] || attr[5] }])\n                advance(attr[0].length)\n            }\n            if (end) {\n                advance(end[0].length);\n            }\n            return match\n        }\n        return false;//不是开始标签\n    }\n    while (html) {\n        let textEnd = html.indexOf('<')\n        if (textEnd == 0) {\n            const startTagMatch = parseStartTag(html)\n            if (startTagMatch) {\n                start(startTagMatch.tagName, startTagMatch.attrs)\n                continue\n            }\n\n        }\n    }\n}\n\nexport function compileToFunction(template) {\n    console.log(template, 'www');\n    parserHTML(template)\n}","import { initState } from './state'\nimport { compileToFunction } from './compiler/index'\n// 原型上添加init方法\nexport function initMixin(Vue) {\n    // 初始化流程\n    Vue.prototype._init = function (options) {\n        // 数据劫持\n        const vm = this //vue中使用this.$options 指代用户的传递属性\n        vm.$options = options\n        // 初始化状态\n        initState(vm)    //vm.$options.data   数据劫持\n        if (vm.$options.el) {\n            //数据挂载模版     自动挂载\n            vm.$mount(vm.$options.el)\n        }\n    }\n    Vue.prototype.$mount = function (el) {\n        const vm = this;\n        const options = vm.$options\n        el = document.querySelector(el);\n        // 把模版转换成对应的渲染函数 =》 虚拟dom概念  vnode =》 diff算法 更新虚拟dom =》产生新节点 更新\n        // render是内置渲染vnode的方法\n        if (!options.render) {\n            let template = options.template;\n            if (!template && el) {\n                template = el.outerHTML\n                let render = compileToFunction(template)\n                console.log(render,'render');\n                options.render = render\n            }\n        }\n    }\n}","import { initMixin } from './init'\n\n\n\nfunction Vue(opation) {\n    // 进行Vue的初始化操作\n    this._init(opation)\n}\n// 通过引入文件的方法给原型上添加一个_init方法\ninitMixin(Vue)   //给Vue上添加一个_init方法\nexport default Vue"],"names":["isFunction","data","isObject","def","key","val","Object","defineProperty","enumerable","configurable","value","oldArryMethods","Array","prototype","arryMethods","create","methods","forEach","item","console","log","args","result","apply","inserted","ob","__ob__","slice","observerArry","Observer","isArray","__proto__","walk","i","length","observer","keys","defineReactive","get","set","newVal","initState","vm","opts","$options","props","initData","computed","watch","proxy","source","_data","call","cname","qnameCapture","startTagOpen","RegExp","attribute","startTagClose","parserHTML","html","advance","len","substring","start","tagName","attr","parseStartTag","match","attrs","end","push","name","textEnd","indexOf","startTagMatch","compileToFunction","template","initMixin","Vue","_init","options","el","$mount","document","querySelector","render","outerHTML","opation"],"mappings":"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"}